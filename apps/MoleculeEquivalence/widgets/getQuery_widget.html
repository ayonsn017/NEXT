<style>
  html,body{
  height:100%;
  }

  div.container{
  height:100%;
  }

  #wrapper {
    height:85%;
  }

  div.row > div.col-xs-6 {
    height:100%;
    outline: 1px solid black;
  }

/*div.modal.in .modal-dialog {
        position:fixed;
        bottom:7%;
        right:20%;
        margin:fixed;
    }*/

/*div.modal.in .modal-dialog.modal {
  max-height: calc(100% - 100px);
  position: absolute;
    top: 50%;
    left: 50%;
  transform: translate(-100%, -100%);
}*/

div.feedback_box {
    background-color: white;
    color: black;
    margin: 20px 0 20px 0;
    padding: 0px;
    display: none;
}

div.instruction_box{
    background-color: white;
    color: black;
    margin: 20px 0 20px 0;
    padding: 0px;
    outline:1px solid black;
}

  div.row > div.col-xs-12 {
    height:100%;
    outline: 1px solid black;
  }

  #wrapper > div.row {
    height:50%;
  }

  #wrapper img{
    max-height:100%;
    max-width:100%;
    height:auto;
  }

</style>
{% if query.ques_type == "instruction" %}
    <div class="instruction_box" id="instruction_div">
        {{ query.target_indices[0]}}
        <br>
        &nbsp;
        &nbsp;
        <button type="button" id="proceeed_btn" class="btn btn-danger"
                        onclick="submit_yes()">Proceed
        </button>
        <br>
    </div>
{% else %}
    <div style="text-align:right;"><span style="font-size:35px;">{{ query.ques_count }}/{{ query.total_ques_count }}</span></div>
    <div>
        <h2>Are the following two molecules the same? </h2>
    </div>

    <br>

    <div class="row">
      <!-- Left Target -->
      <div class="col-xs-6" id="left">
        {% if query.target_indices[0].primary_type == "image" or query.target_indices[0].primary_type == "img"%}
        <img class="center-block" src={{ query.target_indices[0].primary_description }}></img>

        {% elif query.target_indices[0].primary_type == "text"%}
        <div>{{ query.target_indices[0].primary_description }}</div>

        {% elif query.target_indices[0].primary_type == "video" %}
        <video width="320" height="240" poster="http://jimpunk.net/Loading/wp-content/uploads/loading1.gif" controls autoplay loop>
          <source src={{ query.target_indices[0].primary_description }} type="video/mp4">
    	Your browser does not support the video tag.
        </video>
        {% endif %}
      </div>

      <!-- Right Target -->
      <div class="col-xs-6" id="right">
        {% if query.target_indices[1].primary_type == "image" or query.target_indices[1].primary_type == "img" %}
        <img class="center-block" src={{ query.target_indices[1].primary_description }}> </img>
        {% elif query.target_indices[1].primary_type == "text" %}
        <div>{{ query.target_indices[1].primary_description }}</div>
        {% elif query.target_indices[0].primary_type == "video" %}
        <video width="320" height="240" poster="http://jimpunk.net/Loading/wp-content/uploads/loading1.gif" controls autoplay loop>
          <source src={{ query.target_indices[1].primary_description }} type="video/mp4">
    	Your browser does not support the video tag.
        </video>
        {% endif %}
      </div>
    </div>
    <div>
    <br>
        
        {% if query.ques_type == "training" %}
        <!-- provide feedback -->
        &nbsp;
        <button id="Yes" type="button" onclick="respond(this.id);">Yes</button>
        <button id="No" type="button" onclick="respond(this.id);">No</button>


        {% else %}
        <!-- no feedback -->
        &nbsp;
        <button type="button" onclick="submit_yes()">Yes</button>
        <button type="button" onclick="submit_no()">No</button>
        {% endif %}
    </div>
    </div>
    <br>
    <!-- Feedback div -->
    <div class="feedback_box" id="feedback_div">
        <h2 id="feedback_text">Feedback message</h2>
        <button type="button" id="proceeed_btn" class="btn btn-danger"
                        onclick="submit_response()">Proceed</button>
    </div>
{% endif %}

<script>

var response;
var feedback_message;
var respond = function(label){
    console.log('setting response variable')       

    // Disable buttons during feedback
    document.getElementById("Yes").disabled = true; 
    document.getElementById("No").disabled = true; 

    // Display modal with feedback
    response = (label === "Yes");
    generate_message({{ query.same }}, response);
    $('#feedback_text').text(feedback_message);

    // Show feedback div
    $('#feedback_div').css('display','block'); 
}

var submit_response = function() {
    /* note: response variable always exists because the variable is assigned before modal
    displays, showing this button that calls this function*/ 
    if (response) {
        submit_yes()
    }
    else {
        submit_no()
    }
}

var generate_message = function(same, response){
    if (same && response){
        feedback_message = "Your answer is Correct. The two molecules are the same.";
    }
    else if (!same && !response){
        feedback_message = "Your answer is Correct. The two molecules are different.";
    }
    else if (!same && response){
        feedback_message = "Your answer is Incorrect. The two molecules are different.";
    }
    else {
        feedback_message = "Your answer is Incorrect. The two molecules are the same.";
    }
}

var submit_yes = function() {
    console.log('Submitting yes');
    next_widget.processAnswer({'target_winner': true, 'participant_uid': "{{ query.participant_uid }}"});    
}

var submit_no = function() {
    console.log('Submitting no');
    next_widget.processAnswer({'target_winner': false, 'participant_uid': "{{ query.participant_uid }}"});
}

</script>


